name: Trigger Webhook

on:
  push:
    branches:
      - web

jobs:
  webhook:
    runs-on: ubuntu-latest

    steps:
    - name: Trigger Webhook
      run: |
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "X-Hub-Signature: sha1=$(echo -n '${{ github.sha }}' | openssl dgst -sha1 -hmac '${{ secrets.WEBHOOK_SECRET }}' | awk '{print $2}')" \
        -d '{"ref": "${{ github.ref }}", "after": "${{ github.sha }}"}' \
        http://elliottsf.eu.pythonanywhere.com/pull
